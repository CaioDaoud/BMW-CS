Word Document Microsoft Word 9 Microsoft Word 9 calpgm files filelist xml CALPGM Program Suite The CALPGM Program Suite CONTENTS spinv html toc DOCUMENTATION for SPFIT and SPCAT dpi html toc DOCUMENTATION for DPFIT and DPCAT fitdoc Adjustment of the Marquardt Levenberg Parameter Using a Trust Region Approach install Installation Instructions Adjustment of Marquardt Levenberg Parameter Using a Trust Region Approach The trust region approach to Marquardt Levenberg parameter adjustment is described in John E Dennis and Robert B Schnabel Numerical Methods for Unsconstrained Optimization and Non linear Equations Prentice Hall 1983 The basic idea is that there is a region over which a linear least squares fit can be trusted First the value of each parameter is scaled so that the squares of the derivatives summed over all the lines is unity Then then a simple least squares fit is atttempted with a value of zero for the Marquardt Levenberg parameter l If the length of the normalized parameter change vector is less than the trust region size then this fit is used Otherwise a new l is found in which length of the normalized parameter change vector is equal to the trust region size In the first iteration the trust region size is set to the length of the parameter change vector when the input value of l is used for the fit For the following iterations the trust region is doubled if it appears that the fit is over damped If the fit is diverging the trust region is changed by a factor of 0 1 to 0 5 and the parameters from the last good fit are used again When the trust region is decreased the corresponding value of l increases It is a good idea to start a fit with the Marquardt Levenberg parameter l set to zero If the fit starts diverging then the trust region will be decreased appropriately toc TOP Installation Instructions The Makefile shows how the various files are to be linked The programs have been tested with http www microsoft com Microsoft Visual C compiler and the gnu gcc compiler which is freely available for http www gnu org unix and http sourceware cygnus com cygwin windows platforms The programs should work without modification with any ANSI compliant c compiler on any size computer All arrays are allocated dynamically and addressing or memory limits will place a practical limit on the size of matrices that can be used For 16 bit computers the address limit is equivalent to a 90 90 double precision matrix while for a 32 bit computer the addressing limit is 23170 23170 The program has been used on a 64 bit DEC alpha computer where the addressing limit is correspondingly larger For both 32 bit and 64 bit computers a more significant practical limit is usually given by the amount of memory or the amount of disk space available for virtual memory The identities of the files are calfit c calcat c and calmrg c are the main programs subfit c is supplementary to calfit ulib c blas c and cnjj c are generic libraries calpgm h cnjj h and blas h are required header files slibgcc c contains system dependent fuctions spinv c contains functions for spins and multiple vibrations The executables using this library and calfit or calcat are called SPFIT and SPCAT respectively dpi c contains functions for doublet pi with a nuclear spin The executables using this library and calfit or calcat are called DPFIT and DPCAT respectively nam are parameter name files for function getlbl in subfit They are only used to label the output from calfit The first default directory is the current directory The second default directory is given in an environment variable named SPECNAME Under windows put a line like set SPECNAME c spectra in autoexec bat Under Unix put a line like setenv SPECNAME home myname in one of your initialization files e g cshrc blas c contains needed LINPACK double precision Basic Linear Algebra Subroutines these may be available on some systems in a machine coded and or vector processor form Makefile is the make file for the gcc compilation spinv html is the specific documentation for the SPFIT and SPCAT and dpi html is the specific documentation for the DPFIT and DPCAT toc TOP
