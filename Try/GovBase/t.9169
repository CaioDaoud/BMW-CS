IDL FITS Astronomy software A description of the methods to access FITS files using the commercial language IDL and the procedures in the IDL astronomy Library FITS I O with IDL FITS I O in the http idlastro gsfc nasa gov homepage html IDL Astronomy Library FITS Flexible Image Transport System is a standardized data format which is widely used in astronomy Although originally conceived as simply a standard interchange format for digital images FITS files are now often used as a working data format and can be used to store ASCII or binary tabular data in addition to images and spectra Detailed information on the FITS format can be obtained from the http www cv nrao edu fits NRAO FITS archive or from the http fits gsfc nasa gov FITS Support Office at Goddard Space Flight Center For information on processing FITS files with FORTRAN or C rather than IDL go to the http heasarc gsfc nasa gov docs software fitsio fitsio html FITSIO Home Page at Goddard Space Flight Center Briefly a FITS file consists of a sequence of one or more Header and Data Units HDUs A header is composed of ASCII card images that in IDL is usually read into a string array variable The header describes the content of the associated data unit which might be a spectrum IDL vector an image IDL array or tabular data in ASCII or binary format often read as an IDL structure Image and vector data can be present in any HDU but tabular data cannot appear in the first HDU The HDUs following the first or primary HDU are also known as extensions and thus a FITS file containing tabular data must contain at least one extension Finally note that FITS is a binary format and so the binary option should be used when copying FITS files with FTP The IDL Astronomy Library contains four different sets of procedures for reading writing and modifying FITS files The reason for having four different methods of FITS I O with IDL is partly historical as different groups developed the software independently However each method also has its own strengths and weakness for any particular task For example the procedure MRDFITS which can read a FITS table into an IDL structure is the easiest procedure for analyzing FITS files at the IDL prompt level provided that one is comfortable with IDL structures But mapping a table into an IDL structure includes extra overhead so that when performing FITS I O at the procedure level it may be desirable to use more efficient procedures such as FITS READ and FTAB EXT The four classes of IDL FITS I O procedures are briefly described below along with the strengths and possible drawbacks of each method MRDFITS MWRFITS ftp pro fits mrdfits pro MRDFITS will read all standard FITS data types into IDL arrays for primary images and image extensions or structures for binary or ASCII tables The procedure ftp pro fits mwrfits pro MWRFITS will write an IDL structure to a FITS file with many options available binary or ASCII table default generation of column names These procedures were written by Tom McGlynn USRA Goddard The use of these procedures is described in their documentation header with further mrdfits html information on MRDFITS available online Strengths These procedures are easy to use and remember the MRDFITS procedure can read any type of FITS file into a single IDL structure variable which is then available for further IDL processing MRDFITS has a fairly long history of use and has been tested with many FITS files In IDL V5 3 or later MRDFITS can be used to directly read gzip compressed files on any machine architecture For versions of IDL prior V5 3 this capability is limited to Unix machines Options are available to read write IDL unsigned data types and to map variable length binary tables into IDL pointers Drawbacks Mapping an entire FITS table extension into an IDL structure can incur extra CPU and virtual memory overhead particularly if one is only interested in a single column The procedures MRDFITS and MWRFITS make use of the following procedures from the IDL Astronomy Library ftp pro fits bintable fxaddpar pro FXADDPAR ftp pro fits bintable fxpar pro FXPAR ftp pro fits bintable fxparpos pro FXPARPOS ftp pro fits fxmove pro FXMOVE ftp pro fits fxposit pro FXPOSIT ftp pro misc gettok pro GETTOK ftp pro misc ieee to host pro IEEE TO HOST ftp pro misc is ieee big pro IS IEEE BIG ftp pro fits mrd hread pro MRD HREAD ftp pro misc mrd skip pro MRD SKIP ftp pro structure mrd struct pro MRD STRUCT and ftp pro misc valid num pro VALID NUM READFITS WRITEFITS ftp pro fits readfits pro READFITS can be used to read FITS headers and arrays of a specified extensions into IDL variables Additional procedures in the ftp pro fits table pro fits table directory are then required to interpret binary and ASCII tables The FT procedures in the fits table directory are used to interpret a FITS ASCII table and the TB procedures are used to interpret a FITS Binary table The procedure ftp pro fits writefits pro WRITEFITS can be used to write a primary image ASCII table extension when used with the FT procedures or image extension Strengths Due to its long history both READFITS and WRITEFITS have undergone extensive testing For FITS files that do not contain tables or many image extensions READFITS and WRITEFITS are as simple and fast as any other method Since IDL V5 3 READFITS can be used to directly read gzip compressed files under any OS Unix Windows MacOS and VMS Drawbacks READFITS currently cannot be used to read variable length binary tables and WRITEFITS cannot be used to create any type of binary table Interactive use of READFITS with FITS tables is somewhat awkward with the user required to supply e g to ftp pro fits table ftget pro FTGET or ftp pro fits table tbget pro TBGET a header array and a data array as separate IDL variables READFITS requires the following supporting procedures ftp pro misc gettok pro GETTOK ftp pro misc strnumber pro STRNUMBER ftp pro fits sxaddpar pro SXADDPAR ftp pro fits sxdelpar pro SXDELPAR ftp pro fits sxpar pro SXPAR and ftp pro misc valid num pro VALID NUM WRITEFITS requires the following additional supporting procedures ftp pro misc break path pro BREAK PATH ftp pro fits check fits pro CHECK FITS ftp pro astro daycnv pro DAYCNV ftp pro misc find with def pro FIND WITH DEF ftp pro fits bintable fxpar pro FXPAR ftp pro fits bintable fxparpos pro FXPARPOS ftp pro fits fxposit pro FXPOSIT ftp pro astro get date pro GET DATE ftp pro fits headfits pro HEADFITS ftp pro misc is ieee big pro IS IEEE BIG ftp pro fits mrd hread pro MRD HREAD ftp pro misc mrd skip pro MRD SKIP ftp pro fits mkhdr pro MKHDR and ftp pro misc strn pro STRN FX Procedures The directory ftp pro fits bintable pro fits bintable contains IDL procedures for FITS I O written by Bill Thompson ARC Goddard and used by the SOHO project This software can be used to read or write all types of FITS images and binary tables Further information on these procedures is available in the LaTeX file ftp text fits bintable tex fits bintable tex In November 1999 C Markwardt added the procedures ftp pro fits bintable fxbwritm pro FXBWRITM and ftp pro fits bintable fxbreadm pro FXBREADM which can greatly improve the speed of the FX procedures by writing and reading multiple FITS binary columns in a single call The http idlastro gsfc nasa gov ftp contrib markwardt Markwardt contrib directory contains modifications of the FX procedures to allow them to read gzip ed files transparently under Unix Strengths These are the most complete and well tested IDL procedures for writing binary tables Drawbacks The FX procedures do not handle ASCII tables They use more loops and thus are slower though less virtual memory intensive than the other IDL FITS I O procedures No current support for IDL unsigned data types FITS and FTAB Procedures The five procedures FITS CLOSE FITS HELP FITS OPEN FITS READ and FITS WRITE were written by D Lindler ACC Goddard and are used by the STIS NICMOS instrument teams for the Hubble Space Telescope HST Documentation is available at the http hires gsfc nasa gov stis docs fitsdoc fitsdoc html STIS Web pages at Goddard Like READFITS WRITEFITS these procedures require further processing of binary and ASCII tables by using procedures in the ftp pro fits table fits table directory In particular the procedure ftp pro fits table ftab ext pro FTAB EXT uses FITS READ to provide a quick and easy extraction of FITS ASCII or Binary tables into IDL vectors Strengths The FITS procedures are the most efficient way to process FITS files with many extensions These are the only IDL procedures to recognize the STScI Inheritance and Implicit Image Conventions These procedures can be used to read write IDL unsigned data types Drawbacks No easy capability for creating binary tables or for reading variable length binary tables Besides the four main categories above other IDL procedures are available for miscellaneous operations with FITS files Once again there are sometimes duplicate procedures to do nearly the same operation ftp pro fits fits info pro FITS INFO or ftp pro fits fits help pro FITS HELP Display information about FITS file s in a directory including the number of extensions and the size and type of each header or array FITS HELP has a nicer format but only does one file at a time ftp pro fits fitsdir pro FITSDIR List selected keywords from the primary or extension headers of a set of FITS files ftp pro fits bintable fxaddpar pro FXADDPAR or ftp pro fits sxaddpar pro SXADDPAR Add or modify a keyword in a FITS header ftp pro fits bintable fxpar pro FXPAR or ftp pro fits sxpar pro SXPAR These functions will return the value of a keyword in a FITS header ftp pro fits headfits pro HEADFITS Read just the FITS header of a specified extension into an IDL string array ftp pro misc hgrep pro HGREP Find a substring in a FITS header or other string array ftp pro misc hprint pro HPRINT A FITS header is a string array with 80 characters per line On many terminals use of the IDL PRINT command to display the header will result in a space between every line The HPRINT procedure will display a FITS header without this extra space and includes options to display only specified lines of a header ftp pro fits mkhdr pro MKHDR or ftp pro fits bintable fxhmake pro FXHMAKE Create a minimal FITS header to match a specified data variable ftp pro fits modfits pro MODFITS Modify a FITS file by updating the header and or data array ftp pro fits rdfits struct pro RDFITS STRUCT will read an entire FITS file into an IDL structure Each header and data array of every extension is placed into a separate structure tag Note that individual table columns are not parsed into separate tags so that this procedure is less generally useful than MRDFITS ftp pro fits sxdelpar pro SXDELPAR Delete a specified keyword in a FITS header Miscellaneous Notes The procedures FITS READ FITS HELP HEADFITS READFITS and MRDFITS can be used to directly read gzip or Unix compressed FITS files Prior to IDL V5 3 this capability was limited to Unix machines since it required the creation of a pipe with the IDL SPAWN command For versions IDL V5 3 or later this capability is available for all machine architectures Windows VMS Macintosh The procedures FTAB PRINT FTAB HELP FITS INFO and FITSDIR use the non standard system variables TEXTUNIT and TEXTOUT These system variables are automatically added to one s session if they are not present prior to compilation Last modified 26 Aug 2003 Wayne Landsman Science Systems and Applications SSAI landsman mpb gsfc nasa gov
